<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>tangina mo patho üñï</title>

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
*{
  box-sizing:border-box;
  cursor:url("images/cursor.png") 8 8, auto;
}
body{
  margin:0;
  background:#ffe6f0;
  color:#4a1f33;
}

/* SCREENS */
.screen{display:none;min-height:100vh}
.screen.active{display:block}

/* ===== PIXEL UI ===== */
.pixel{
  font-family:'Press Start 2P';
}
.pixel-btn{
  font-family:'Press Start 2P';
  padding:10px;
  background:#ff85b3;
  border:none;
  border-radius:10px;
  color:white;
}

/* ===== HOME ===== */
#home{
  text-align:center;
  padding:40px;
}
#home h1{
  font-size:28px;
  color:#d63384;
}
.chapter-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
  margin-top:30px;
}
.chapter{
  background:#fff0f6;
  border:4px solid #ff9ecf;
  border-radius:16px;
  padding:20px;
}
.mascot{
  margin-top:20px;
}
.mascot img{width:80px}

/* ===== EXAM ===== */
#exam{
  display:flex;
}
.sidebar{
  width:180px;
  background:#ffd1e8;
  padding:10px;
}
.qbtn{
  width:100%;
  margin:4px 0;
  padding:6px;
  font-size:9px;
  border:2px solid #ff85b3;
  background:#ffe0ef;
  border-radius:6px;
}
.qbtn.answered{background:#b8f2c2}
.qbtn.flagged{border-style:dashed}

.main{
  flex:1;
  padding:16px;
  font-family:'Inter';
}
.header{
  display:flex;
  justify-content:space-between;
  font-family:'Press Start 2P';
  font-size:9px;
}
.progress{
  height:10px;
  background:#ffd1e8;
  border-radius:10px;
  margin:6px 0;
}
.bar{
  height:100%;
  width:0;
  background:#ff85b3;
  border-radius:10px;
}
.question-box{
  border:2px solid #ff9ecf;
  border-radius:10px;
  padding:8px;
  margin-bottom:8px;
}
.question{
  font-size:13px;
}
.choices{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:6px;
  margin-top:6px;
}
.choice{
  padding:6px;
  border:2px solid #ff85b3;
  border-radius:6px;
  background:#ffe0ef;
  font-size:12px;
}
.choice:hover{background:#ffb3d9}

/* ===== REVIEW ===== */
#review{
  padding:20px;
  font-family:'Inter';
}
.review-q{
  border:2px solid #ff9ecf;
  border-radius:12px;
  padding:12px;
  margin-bottom:12px;
}
.correct{background:#b8f2c2}
.wrong{background:#ffb3b3}
.rationale{
  margin-top:6px;
  font-size:13px;
}
</style>
</head>

<body>

<!-- HOME -->
<div id="home" class="screen active pixel">
  <h1>tangina mo patho üñï</h1>
  <p>üìö grind responsibly</p>

  <div class="mascot">
    <img src="images/cat.gif"><br>
    üê± kaya mo yan beh
  </div>

  <div class="chapter-grid">
    <div class="chapter">
      üß¨ Chapter 1  
      <p>Cell Injury</p>
      <button class="pixel-btn" onclick="startExam('ch1')">‚ñ∂ Start Exam</button>
    </div>
    <div class="chapter">
      üî• Chapter 2  
      <p>Inflammation</p>
      <button class="pixel-btn" onclick="startExam('ch2')">‚ñ∂ Start Exam</button>
    </div>
  </div>
</div>

<!-- EXAM -->
<div id="exam" class="screen">
  <div class="sidebar" id="sidebar"></div>
  <div class="main">
    <div class="header">
      <div id="timer">‚è±Ô∏è 20:00</div>
      <button class="pixel-btn" onclick="submitExam()">Submit Exam</button>
    </div>
    <div class="progress"><div class="bar" id="bar"></div></div>
    <div id="page"></div>
    <div class="pixel">
      <button onclick="prevPage()">‚¨Ö Prev</button>
      <button onclick="nextPage()">Next ‚û°</button>
    </div>
  </div>
</div>

<!-- REVIEW -->
<div id="review" class="screen">
  <h2 class="pixel">Review</h2>
  <div id="reviewList"></div>
  <button class="pixel-btn" onclick="goHome()">üè† Home</button>
  <button class="pixel-btn" onclick="retake()">üîÅ Retake</button>
</div>

<script>
/* ===== QUESTION BANK ===== */
const bank={
ch1:[
{q:"Earliest abnormality in reversible cell injury?",c:["DNA fragmentation","ATP depletion","Membrane rupture","Lysosomal leakage"],a:1,r:"ATP depletion is the earliest event."},
{q:"Cell swelling in hypoxia is due to:",c:["Ca pumps","Na/K ATPase","DNA damage","Protein folding"],a:1,r:"Failure of Na/K ATPase causes water influx."},
{q:"Irreversible cell injury is marked by:",c:["Fatty change","Mito swelling","Membrane rupture","Ribosome loss"],a:2,r:"Loss of membrane integrity commits cell to death."},
{q:"Key ion in cell injury?",c:["Na","K","Ca","Cl"],a:2,r:"Calcium activates destructive enzymes."},
{q:"ROS cause injury via:",c:["ATP loss","Lipid peroxidation","DNA synthesis","Protein folding"],a:1,r:"ROS damage membranes."},
{q:"Coagulative necrosis occurs in:",c:["Brain","TB","Pancreatitis","MI"],a:3,r:"Ischemia in solid organs."},
{q:"Liquefactive necrosis is seen in:",c:["Heart","Kidney","Brain","Spleen"],a:2,r:"Brain infarcts liquefy."},
{q:"Apoptosis requires:",c:["Inflammation","ATP","Cell swelling","Membrane rupture"],a:1,r:"Apoptosis is energy dependent."},
{q:"Hypertrophy increases:",c:["Cell number","Cell size","DNA","Apoptosis"],a:1,r:"Protein synthesis enlarges cells."},
{q:"Metaplasia is:",c:["Irreversible","Adaptive","Malignant","Necrotic"],a:1,r:"Metaplasia is a reversible adaptation."}
],
ch2:[
{q:"First vascular response in inflammation?",c:["Permeability","Vasodilation","Adhesion","Exudation"],a:1,r:"Vasodilation occurs first."},
{q:"Histamine is released from:",c:["Neutrophils","Mast cells","Macrophages","Platelets"],a:1,r:"Mast cells store histamine."},
{q:"Mediator of pain?",c:["Histamine","Bradykinin","NO","IL-10"],a:1,r:"Bradykinin causes pain."},
{q:"Dominant cell in acute inflammation?",c:["Lymphocyte","Macrophage","Neutrophil","Eosinophil"],a:2,r:"Neutrophils dominate early."},
{q:"Leukocyte rolling is mediated by:",c:["Integrins","Selectins","PECAM","ICAM"],a:1,r:"Selectins mediate rolling."},
{q:"Firm adhesion uses:",c:["Selectins","Integrins","Histamine","PGs"],a:1,r:"Integrins cause firm adhesion."},
{q:"Diapedesis uses:",c:["ICAM","PECAM","Selectins","TNF"],a:1,r:"PECAM mediates transmigration."},
{q:"Fever is caused by:",c:["IL-10","TNF","IL-1","Histamine"],a:2,r:"IL-1 induces fever."},
{q:"Acute phase reactants are produced by:",c:["Kidney","Liver","Spleen","Bone marrow"],a:1,r:"Liver produces CRP and fibrinogen."},
{q:"Chronic inflammation involves:",c:["Neutrophils","Macrophages","Basophils","Mast cells"],a:1,r:"Macrophages dominate chronic inflammation."}
]
};

/* ===== STATE ===== */
let questions=[],answers=[],flags=[],page=0,time=20*60,timerInt,activeChapter;

/* ===== START ===== */
function startExam(ch){
 activeChapter=ch;
 questions=[...bank[ch]].sort(()=>Math.random()-0.5);
 answers=[];flags=[];page=0;time=20*60;
 home.classList.remove("active");
 exam.classList.add("active");
 buildSidebar();
 renderPage();
 startTimer();
}

/* ===== SIDEBAR ===== */
function buildSidebar(){
 sidebar.innerHTML="";
 questions.forEach((_,i)=>{
  const b=document.createElement("button");
  b.className="qbtn";
  b.textContent="Q"+(i+1);
  b.onclick=()=>{page=Math.floor(i/10);renderPage()};
  sidebar.appendChild(b);
 });
}

/* ===== PAGE RENDER ===== */
function renderPage(){
 pageEl.innerHTML="";
 const start=page*10;
 questions.slice(start,start+10).forEach((q,idx)=>{
  const qi=start+idx;
  const box=document.createElement("div");
  box.className="question-box";
  box.innerHTML=`<div class="question">${qi+1}. ${q.q}</div>`;
  const ch=document.createElement("div");
  ch.className="choices";
  q.c.forEach((t,i)=>{
    const b=document.createElement("button");
    b.className="choice";
    b.textContent=t;
    b.onclick=()=>{answers[qi]=i;updateUI()};
    ch.appendChild(b);
  });
  box.appendChild(ch);
  pageEl.appendChild(box);
 });
 updateUI();
}
const pageEl=document.getElementById("page");

/* ===== UI ===== */
function updateUI(){
 document.querySelectorAll(".qbtn").forEach((b,i)=>{
  b.classList.toggle("answered",answers[i]!=null);
  b.classList.toggle("flagged",flags[i]);
 });
 bar.style.width=(answers.filter(v=>v!=null).length/questions.length*100)+"%";
}
function nextPage(){if((page+1)*10<questions.length){page++;renderPage()}}
function prevPage(){if(page>0){page--;renderPage()}}

/* ===== TIMER ===== */
function startTimer(){
 clearInterval(timerInt);
 timerInt=setInterval(()=>{
  time--;
  timer.textContent=`‚è±Ô∏è ${Math.floor(time/60)}:${(time%60).toString().padStart(2,"0")}`;
  if(time<=0)submitExam();
 },1000);
}

/* ===== SUBMIT / REVIEW ===== */
function submitExam(){
 clearInterval(timerInt);
 exam.classList.remove("active");
 review.classList.add("active");
 reviewList.innerHTML="";
 questions.forEach((q,i)=>{
  const div=document.createElement("div");
  div.className="review-q";
  q.c.forEach((c,ci)=>{
    const span=document.createElement("div");
    span.textContent=c;
    if(ci===q.a)span.classList.add("correct");
    if(answers[i]===ci&&ci!==q.a)span.classList.add("wrong");
    div.appendChild(span);
  });
  div.innerHTML=`<b>${i+1}. ${q.q}</b><br>`+div.innerHTML+
    `<div class="rationale">üìù ${q.r}</div>`;
  reviewList.appendChild(div);
 });
}
function goHome(){
 review.classList.remove("active");
 home.classList.add("active");
}
function retake(){
 review.classList.remove("active");
 startExam(activeChapter);
}
</script>

</body>
</html>
