<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PathQuest</title>

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
*{
  font-family:'Press Start 2P',cursive;
  box-sizing:border-box;
  cursor:url("images/cursor.gif") 8 8, auto;
}

body{
  margin:0;
  background:#ffe6f0;
  color:#5a2a3b;
  height:100vh;
}

/* ===== MAP SCREEN ===== */
#map{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  height:100vh;
}

.map-btn{
  width:260px;
  padding:16px;
  margin:10px;
  background:#ffb3d9;
  border:3px solid #ff85b3;
  border-radius:14px;
  font-size:12px;
  cursor:pointer;
}

/* ===== LAYOUT ===== */
#quiz{
  display:none;
  height:100vh;
  display:flex;
}

/* SIDEBAR */
.sidebar{
  width:180px;
  background:#ffd1e8;
  border-right:4px solid #ff85b3;
  padding:10px;
  overflow-y:auto;
}
.qbtn{
  width:100%;
  margin:4px 0;
  padding:6px;
  font-size:9px;
  background:#ffe0ef;
  border:2px solid #ff85b3;
  border-radius:8px;
}
.qbtn.answered{background:#b8f2c2}

/* MAIN */
.main{
  flex:1;
  padding:20px;
  overflow-y:auto;
}

.box{
  max-width:720px;
  margin:auto;
  background:#fff0f6;
  border:4px solid #ff9ecf;
  border-radius:16px;
  padding:20px;
}

/* HEADER */
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.score{
  font-size:10px;
}

/* PROGRESS */
.progress{
  width:100%;
  height:14px;
  background:#ffd1e8;
  border-radius:10px;
  margin:10px 0;
}
.bar{
  height:100%;
  width:0%;
  background:#ff85b3;
  border-radius:10px;
}

/* MASCOT */
.mascot{
  display:flex;
  gap:12px;
  align-items:center;
  margin:10px 0;
}
.mascot img{width:60px}
.speech{
  background:white;
  border:3px solid #ff85b3;
  border-radius:12px;
  padding:8px;
  font-size:10px;
}

/* IMAGE */
.quiz-img{
  width:100%;
  border:3px solid #ff85b3;
  border-radius:10px;
  margin:12px 0;
  cursor:zoom-in;
}

/* ZOOM */
.zoom{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  align-items:center;
  justify-content:center;
}
.zoom img{
  max-width:90%;
  max-height:90%;
  border:5px solid white;
}

/* CHOICES */
.choice{
  width:100%;
  padding:14px;
  margin:8px 0;
  background:#ffe0ef;
  border:2px solid #ff85b3;
  border-radius:12px;
  font-size:12px;
}
.choice:hover{background:#ffb3d9}
.correct{background:#b8f2c2!important}
.wrong{background:#ffb3b3!important}

/* NAV */
.nav{
  display:flex;
  justify-content:space-between;
  margin-top:14px;
}
.nav button{
  width:48%;
  padding:10px;
  background:#ff85b3;
  color:white;
  border:none;
  border-radius:10px;
}
</style>
</head>

<body>

<!-- ===== MAP SCREEN ===== -->
<div id="map">
  <h1>üå∏ PathQuest üå∏</h1>
  <button class="map-btn" onclick="start('general')">üß¨ General Pathology</button>
  <button class="map-btn" onclick="start('liver')">üçñ Liver Pathology</button>
</div>

<!-- ===== QUIZ ===== -->
<div id="quiz">
  <div class="sidebar" id="sidebar"></div>

  <div class="main">
    <div class="box">

      <div class="header">
        <div class="score" id="score">Score: 0</div>
        <button onclick="backToMap()">üó∫Ô∏è Map</button>
      </div>

      <div class="progress"><div class="bar" id="bar"></div></div>

      <div class="mascot">
        <img src="images/cat.gif">
        <div class="speech" id="speech">Let‚Äôs go!</div>
      </div>

      <p id="question"></p>
      <img id="image" class="quiz-img" onclick="zoomImg()">

      <div id="choices"></div>
      <p id="why" style="font-size:10px;display:none"></p>

      <div class="nav">
        <button onclick="prevQ()">‚¨Ö Back</button>
        <button onclick="nextQ()">Next ‚û°</button>
      </div>
    </div>
  </div>
</div>

<!-- ZOOM -->
<div class="zoom" id="zoom" onclick="closeZoom()">
  <img id="zoomImg">
</div>

<script>
/* ===== QUESTION BANK ===== */
const banks={
general:[
{q:"Brain infarct necrosis?",img:"images/brain_liquefactive.jpg",
c:["Coagulative","Caseous","Liquefactive","Fat"],a:2,w:"Brain ‚Üí liquefactive necrosis"},
{q:"Necrosis preserving architecture?",img:"images/coagulative_necrosis.jpg",
c:["Liquefactive","Coagulative","Caseous","Fat"],a:1,w:"Ischemia ‚Üí coagulative"}
],
liver:[
{q:"Liver change shown?",img:"images/fatty_liver.jpg",
c:["Fibrosis","Fatty change","Cirrhosis","Necrosis"],a:1,w:"Fat vacuoles in hepatocytes"}
]
};

let quiz=[],i=0,score=0,answered=[];

/* ===== FLOW ===== */
function start(sys){
 quiz=banks[sys];
 answered=Array(quiz.length).fill(false);
 i=0; score=0;
 document.getElementById("map").style.display="none";
 document.getElementById("quiz").style.display="flex";
 buildSidebar(); load();
}

function backToMap(){
 document.getElementById("quiz").style.display="none";
 document.getElementById("map").style.display="flex";
}

function buildSidebar(){
 const s=document.getElementById("sidebar");
 s.innerHTML="";
 quiz.forEach((_,x)=>{
  const b=document.createElement("button");
  b.className="qbtn";
  b.innerText="Q"+(x+1);
  b.onclick=()=>{i=x;load()};
  s.appendChild(b);
 });
}

function updateUI(){
 document.getElementById("score").innerText="Score: "+score;
 document.getElementById("bar").style.width=((answered.filter(v=>v).length/quiz.length)*100)+"%";
 document.querySelectorAll(".qbtn").forEach((b,x)=>{
  if(answered[x]) b.classList.add("answered");
 });
}

function load(){
 const q=quiz[i];
 document.getElementById("question").innerText=q.q;
 document.getElementById("image").src=q.img;
 const c=document.getElementById("choices");
 c.innerHTML="";
 q.c.forEach((t,x)=>{
  const b=document.createElement("button");
  b.className="choice";
  b.innerText=t;
  b.onclick=()=>answer(b,x);
  c.appendChild(b);
 });
 document.getElementById("why").style.display="none";
 updateUI();
}

function answer(btn,x){
 if(answered[i])return;
 const q=quiz[i];
 if(x===q.a){btn.classList.add("correct");score++;speech("‚ú® Correct!")}
 else{btn.classList.add("wrong");speech("üòø Oops")}
 document.getElementById("why").innerText=q.w;
 document.getElementById("why").style.display="block";
 answered[i]=true; updateUI();
}

function nextQ(){if(i<quiz.length-1){i++;load()}}
function prevQ(){if(i>0){i--;load()}}

function speech(t){document.getElementById("speech").innerText=t}

/* ZOOM */
function zoomImg(){
 document.getElementById("zoomImg").src=document.getElementById("image").src;
 document.getElementById("zoom").style.display="flex";
}
function closeZoom(){document.getElementById("zoom").style.display="none"}
</script>

</body>
</html>
